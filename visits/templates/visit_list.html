{% extends "base.html" %}
{% block title %}Mis visitas{% endblock %}

{% block content %}
<div class="container py-4">
  <h1 class="h4 mb-4">Mis visitas agendadas</h1>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }}">{{ message }}</div>
    {% endfor %}
  {% endif %}

  {% if visits %}
    <div class="list-group">
      {% for visit in visits %}
        <div class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <strong>{{ visit.property.title }}</strong><br>
            <small>{{ visit.date_time|date:"d/m/Y H:i" }} – 
              <span class="badge 
                {% if visit.status == 'confirmed' %} bg-success
                {% elif visit.status == 'cancelled' %} bg-danger
                {% else %} bg-secondary {% endif %}">
                {{ visit.get_status_display }}
              </span>
            </small>
          </div>
          <div>
            {% if visit.status == 'pending' %}
              <a href="{% url 'visit_confirm' visit.id %}" class="btn btn-sm btn-outline-success">Confirmar</a>
              <a href="{% url 'visit_cancel' visit.id %}" class="btn btn-sm btn-outline-danger">Cancelar</a>
            {% endif %}
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <div class="alert alert-info">
      No tienes visitas agendadas todavía.  
      <a href="{% url 'property_list' %}" class="alert-link">Ir a propiedades</a>.
    </div>
  {% endif %}
</div>
{% endblock %}

